#Linux_commands #磁盘管理
[toc]
# LVM 定义
> 逻辑卷管理器（Logical Volume Manager，LVM）。
> LVM允许用户对硬盘资源进行动态调整。

> LVM是Linux系统用于对硬盘分区进行管理的一种机制，其是在硬盘分区和文件系统之间添加了一个逻辑层，它提供了一个抽象的卷组，可以把多块硬盘进行卷组合并。

![[../../../A-Accessories-Note附件/逻辑卷管理器的技术结构.png]]

![[../../../A-Accessories-Note附件/逻辑卷管理器使用流程图.png]]

- 物理卷处于LVM中的最底层，可以将其理解为物理硬盘、硬盘分区或者RAID磁盘阵列。
- 卷组建立在物理卷之上，一个卷组能够包含多个物理卷，而且在卷组创建之后也可以继续向其中添加新的物理卷。
- 逻辑卷是用卷组中空闲的资源建立的，并且逻辑卷在建立后可以动态地扩展或缩小空间。这就是LVM的核心理念。

## 常用命令合集
| 功能/命令 | 物理卷管理 | 卷组管理  | 逻辑卷管理 |
|:---------:|:----------:|:---------:|:----------:|
|   扫描    |   pvscan   |  vgscan   |   lvscan   |
|   建立    |  pvcreate  | vgcreate  |  lvcreate  |
|   显示    | pvdisplay  | vgdisplay | lvdispaly  |
|   删除    |  pvremove  | vgremove  |  lvremove  |
|   扩展    |  添加磁盘  | vgextend  |  lvextend  |
|   缩小    |  删除磁盘  | vgreduce  |  lvreduce  |

## 命令详解
### 磁盘修改类命令

> fdisk

- **管理磁盘分区**
- 格式：`fdisl [参数] [设备名]`

| 参数 | 说明                         |
| ---- | ---------------------------- |
| -b   | 设置每个分区的大小           |
| -c   | 关闭DOS兼容模式              |
| -C   | 设置硬盘的柱面数量           |
| -h   |                              |
| -H   | 设置硬盘的磁头数             |
| -l   | 显示指定的外围设备分区表状态 |
| -s   | 显示指定的分区大小           |
| -S   | 设置每个磁道的扇区数         |
| -u   | 以分区                             |

> pvcreate

- **创建物理卷设备**

- 格式：`pvcreate 参数 物理卷`

| 参数 | 说明                     |
| ---- | ------------------------ |
| -f   | 强制创建物理卷二不询问   |
| -u   | 设置设备的UUID           |
| -y   | 所有询问均回答自动yes    |
| -z   | 设置是否使用最前面的扇区 |


> vgcreate

- **创建卷组设备**

- 格式：`vgcreate [参数] 卷组名 设备名`

| 参数 | 说明                             |
| ---- | -------------------------------- |
| -l   | 设置卷组上允许最大逻辑卷数       |
| -p   | 设置卷组中允许添加的最大物理卷数 |
| -s   | 设置卷组中物理卷的PE大小         |

> lvcreate

- **创建逻辑卷设备**

- 格式：`lvcreate 参数 逻辑卷`

| 参数 | 说明                       |
| ---- | -------------------------- |
| -A   | 设置逻辑卷的可用性         |
| -c   | 设置快照逻辑卷的块大小     |
| -C   | 设置逻辑卷的连续分配策略   |
| -i   | 设置条带数量               |
| -I   | 设置逻辑卷的大小（PE个数） |
| -L   | 设置逻辑卷的大小（容量值） |
| -m   | 创建一个镜像逻辑卷         |
| -n   | 设置新的逻辑卷名           |
| -p   | 设置逻辑卷的访问权限       |
| -r   | 设置逻辑卷的超前读取扇区数 |
| -s   | 为指定的逻辑卷创建快照卷   |
| -T   | 创建精简逻辑卷             |

> resize2fs

- **同步文件系统容量到内核**

- 格式：`resize2fs [参数] 设备名`

| 参数 | 说明                       |
| ---- | -------------------------- |
| -d   | 打开调试特性               |
| -f   | 强制条真正设备容量而不询问 |
| -F   | 刷新文件系统设备的缓冲区   |
| -M   | 将文件系统缩小到最小值     |
| -p   | 显示已完成的百分比进度条   |
| -P   | 显示文件系统的最小值       | 


### 磁盘查看类命令

> lsblk

- 查看系统的磁盘使用情况
- 格式： `lsblk [参数]`

| 参数 | 说明                        |
| ---- | --------------------------- |
| -a   | 显示所有设备信息            |
| -b   | 显示以字节为单位的设备大小  |
| -e   | 排除指定设备                |
| -f   | 显示文件系统信息            |
| -i   | 仅使用字符                  |
| -m   | 显示权限信息                |
| -o   | 输出列信息                  |
| -P   | 使用“key=value”格式心事信息 |
| -r   | 使用原始格式显示信息        |
| -t   | 显示拓扑结构信息            |


