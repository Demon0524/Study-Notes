
# 文件内容
## Dockerfile
> 使用 centos 7.8.2003 作为基础镜像
```perl
[node2@Serverb web_simple]$ ll
总用量 8
-rw-rw-r-- 1 node2 node2 222 5月  29 16:20 Centos-Base.repo
-rw-rw-r-- 1 node2 node2 204 5月  29 16:16 Dockerfile

[node2@Serverb web_simple]$ cat Dockerfile 
FROM centos:7.8.2003
RUN rm -rf /etc/yum.repo/
COPY Centos-Base.repo /etc/yum.repo
RUN yum clean all && yum makecache && yum install -y httpd apache iproute
EXPOSE 80
CMD ["/usr/sbin/httpd","-D","FOREGROUND"]
```
 ### 生成docker image
```perl
[node2@Serverb web_simple]$ docker build -t web_simple:1.0 .
# 过程省略
[node2@Serverb web_simple]$ docker images
REPOSITORY     TAG        IMAGE ID       CREATED          SIZE
web_simple     1.0        0f16e7901202   56 seconds ago   756MB
centos         7.8.2003   afb6fca791e0   4 years ago      203MB
```


## 创建docker volume

> 将文件存储在本地
```perl
[node2@Serverb web_simple]$ docker volume create -d local docker_data
docker_data
[node2@Serverb web_simple]$ docker volume ls
DRIVER    VOLUME NAME
local     docker_data
```


## 创建docker network
> 创建bridge类型网络
> 创建新的bridge网络能够实现自动DNS
```perl
[node2@Serverb centos_nginx]$ docker network create --driver bridge bridge_test
d3455819d3574ace27bca75300bbc0ab89bc70eec35cf7dbde4dc54b2a3ff260
[node2@Serverb centos_nginx]$ docker network ls
NETWORK ID     NAME          DRIVER    SCOPE
624a8a910bc8   bridge        bridge    local
d3455819d357   bridge_test   bridge    local
e36c702a1b18   host          host      local
47e34eef3822   none          null      local
```

# 运行容器

## 使用命令运行
```perl
[node2@Serverb web_simple]$ docker run -d -p 8080:80 --network bridge_test -v docker_volume/data --name web_simple web_simple:1.0 
03872637908b0c68bb3963f0dfb759d37b236298d41ba242062f7841da5234b4
[node2@Serverb web_simple]$ docker ps -a
CONTAINER ID   IMAGE            COMMAND                   CREATED         STATUS         PORTS                                   NAMES
03872637908b   web_simple:1.0   "/usr/sbin/httpd -D …"   5 seconds ago   Up 3 seconds   0.0.0.0:8080->80/tcp, :::8080->80/tcp   web_simple
```
### 查看容器IP
```perl
[node2@Serverb web_simple]$ docker exec -it 03872637908b bash
[root@03872637908b /]# ip a | grep 172
    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth0
```


## 测试
### 网页访问
```perl
curl 192.168.238.102:8080
```

### DNS测试
> 使用test-web ping web_simple
```perl
[node2@Serverb ~]$ docker run -d -p 8081:80 --network bridge_test -v docker_volume/data --name test-web web_simple:1.0 
ded97c67cd62399323d4e01aa7478859dc3023d2afb75e1fccf55445a76dea21

[node2@Serverb ~]$ docker exec -it test-web bash
[root@ded97c67cd62 /]# ping web_simple
PING web_simple (172.18.0.2) 56(84) bytes of data.
64 bytes from web_simple.bridge_test (172.18.0.2): icmp_seq=1 ttl=64 time=0.061 ms
^C
--- web_simple ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.061/0.061/0.061/0.000 ms
```

